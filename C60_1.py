from numpy import array, nan

neighbours_shape = [60,3];
points_shape     = [60,3];
dual_neighbours_shape = [32,6];
triangles_shape = [60,3];
rspi         = array([1,2,3,4,5,6,27,28,29,30,31,32])

# Cubic graph, its faces, and 3D embedding
cubic_neighbours  = array([4,12,1,0,10,2,1,8,3,2,5,4,3,7,0,3,9,6,5,30,7,6,14,4,2,11,9,8,33,5,1,13,11,10,35,8,0,14,13,12,37,10,7,32,12,19,21,16,15,27,17,16,29,18,17,59,19,18,22,15,22,25,21,20,24,15,19,51,20,25,28,24,23,27,21,20,54,23,28,29,27,26,16,24,23,56,26,26,58,17,6,34,31,30,40,32,31,39,14,9,36,34,33,43,30,11,38,36,35,45,33,13,39,38,37,47,35,32,42,37,31,44,41,40,50,42,41,49,39,34,46,44,43,53,40,36,48,46,45,55,43,38,49,48,47,57,45,42,52,47,41,54,51,50,22,52,51,59,49,44,56,54,53,25,50,46,58,56,55,28,53,48,59,58,57,29,55,52,18,57]).reshape(neighbours_shape);

pentagons    = array([[[0,1,2,3,4],[5,6,7,4,3],[8,9,5,3,2],[10,11,8,2,1],[12,13,10,1,0],[7,14,12,0,4],[15,16,17,18,19],[20,21,15,19,22],[23,24,21,20,25],[26,27,24,23,28],[17,16,27,26,29],[16,15,21,24,27]]]);

hexagons     = array([[[30,31,32,14,7,6],[9,33,34,30,6,5],[11,35,36,33,9,8],[13,37,38,35,11,10],[14,32,39,37,13,12],[40,41,42,39,32,31],[34,43,44,40,31,30],[36,45,46,43,34,33],[38,47,48,45,36,35],[39,42,49,47,38,37],[50,51,52,49,42,41],[44,53,54,50,41,40],[46,55,56,53,44,43],[48,57,58,55,46,45],[49,52,59,57,48,47],[22,19,18,59,52,51],[54,25,20,22,51,50],[56,28,23,25,54,53],[58,29,26,28,56,55],[59,18,17,29,58,57]]]);

next_on_face = array([7,13,2,12,11,3,10,9,4,8,6,0,5,14,1,2,33,7,9,31,4,30,12,3,1,35,5,11,34,3,0,37,8,13,36,2,4,32,10,14,38,1,6,39,0,22,24,17,21,26,18,27,58,19,29,52,15,59,20,16,51,23,15,25,27,19,18,50,21,54,26,21,28,16,20,22,53,24,56,17,24,29,15,23,25,55,27,28,57,16,5,43,32,34,41,14,40,37,7,8,45,30,36,44,6,10,47,33,38,46,9,12,42,35,39,48,11,31,49,13,30,53,42,44,51,39,50,47,32,33,55,40,46,54,31,35,57,43,48,56,34,37,52,45,49,58,36,41,59,38,40,25,52,54,19,49,22,57,42,43,28,50,56,20,41,45,29,53,58,23,44,47,18,55,59,26,46,51,17,48]).reshape(neighbours_shape);

prev_on_face = array([3,14,10,4,13,8,0,11,5,1,9,7,2,6,12,4,8,30,3,34,14,5,32,0,3,10,33,2,36,6,2,12,35,1,38,9,1,7,37,0,39,11,4,31,13,18,20,27,19,24,29,15,26,59,16,57,22,17,51,21,19,54,24,22,23,16,15,52,25,20,56,27,25,26,15,21,50,28,23,58,16,28,17,21,24,53,29,27,55,18,7,33,40,6,44,39,30,42,12,5,35,43,9,46,31,8,37,45,11,48,34,10,32,47,13,49,36,14,41,38,32,43,50,31,54,49,40,52,37,30,45,53,34,56,41,33,47,55,36,58,44,35,42,57,38,59,46,39,51,48,42,53,22,41,20,59,50,18,47,40,55,25,44,23,51,43,57,28,46,26,54,45,52,29,48,17,56,49,19,58]).reshape(neighbours_shape);

face_right   = array([5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,5,6,6,5,6,5,5,5,6,5,6,6,5,5,6,5,6,6,5,5,6,5,6,6,5,6,6,5,5,5,5,5,5,5,5,6,5,6,6,5,6,5,5,6,5,5,5,5,5,6,6,5,6,5,5,5,5,5,6,6,5,6,5,5,5,5,5,6,6,5,6,6,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6]).reshape(neighbours_shape);

points_start = array([2.79681,0.516113,13.0222,6.76514,0.57774,11.7327,8.34022,6.05953,9.27994,2.64001,6.2555,11.7327,1.35511,2.50044,13.0222,0.236745,9.93523,9.27994,-3.99592,4.32595,11.7327,-0.977597,1.74249,13.0222,10.3245,7.50122,5.90401,3.56292,12.0524,5.90401,9.52212,-2.845,9.27994,12.5636,-0.33587,5.90401,1.35511,-1.46821,13.0222,2.87942,-5.13714,11.7327,-0.977597,-0.710266,13.0222,1.30866,-1.48271,-13.3243,2.79531,0.595135,-13.3243,6.69338,-0.415353,-12.0349,7.23486,-6.29382,-9.5821,1.02313,-5.53089,-12.0349,-4.1883,-3.04298,-12.0349,-0.977597,-0.710266,-13.3243,-3.35451,-7.99393,-9.5821,-4.94402,2.6822,-12.0349,-1.00574,1.70279,-13.3243,-8.63928,-0.720068,-9.5821,1.67334,6.49413,-12.0349,1.42981,2.47459,-13.3243,-3.75008,8.82565,-9.5821,5.60904,4.0752,-12.0349,-7.8136,4.55172,9.27994,-8.32628,-2.18262,9.27994,-4.1883,-3.04298,11.7327,4.78525,13.0433,1.93536,-9.95789,5.75179,5.90401,13.8836,0.520443,1.93536,11.3678,8.25916,-2.23752,1.91441,-8.83773,9.27994,2.39312,-11.2479,5.90401,-4.64875,-7.24429,9.27994,-10.2297,-4.12493,5.90401,-9.94703,-7.22694,1.93536,-7.08419,-8.45433,5.90401,-8.81305,9.61773,1.93536,-12.4509,1.07726,1.93536,10.3245,7.50122,-6.20616,-1.83775,13.4406,-2.23752,6.42363,-11.3537,1.93536,12.2149,-5.90118,-2.23752,-2.82302,-12.1744,1.93536,-9.94703,-7.22694,-2.23752,-6.1621,-9.1789,-6.20616,-4.03965,-11.771,-2.23752,-12.4432,-0.204508,-2.23752,-10.6338,-3.02406,-6.20616,-1.00605,12.2753,-6.20616,-10.0767,5.50252,-6.20616,11.3636,-4.75008,-6.20616,8.34022,6.05953,-9.5821,2.11935,-11.2838,-6.20616]).reshape(points_shape);

points_opt   = array([0.780063,-0.387561,5.83873,2.1445,0.0840456,5.48188,2.08295,1.55533,5.27639,0.678184,1.9902,5.49516,-0.126053,0.789559,5.84336,0.158229,2.54625,4.22158,-1.05294,1.73839,3.85569,-1.15135,0.589607,4.78901,2.44701,1.84716,3.86668,1.29275,2.60195,3.27194,2.53659,-0.549774,4.19863,2.85849,0.565123,3.24808,0.318942,-1.32451,4.78397,1.46765,-1.51359,3.84491,-0.96442,-0.79863,4.2583,-0.621073,-1.95159,-5.53606,0.221181,-0.764873,-5.82506,1.20045,-0.612316,-4.72039,1.03883,-1.79626,-3.8202,-0.15453,-2.5473,-4.26024,-2.41872,-1.7891,-3.95293,-2.01922,-1.48778,-5.34832,-1.31482,-2.57904,-3.33999,-2.46861,0.608131,-4.25548,-2.04411,-0.0144497,-5.534,-2.8303,-0.497911,-3.32468,-0.2224,1.34168,-4.74858,-0.660166,0.431932,-5.83441,-1.39838,1.57384,-3.86137,1.02313,0.755736,-4.16756,-1.13528,1.37212,2.50301,-1.54449,0.121045,2.06366,-1.09613,-0.898609,2.8836,0.922913,2.18908,1.98754,-0.377324,2.00752,1.57472,2.33366,0.40909,1.96202,1.75702,1.43068,1.24372,1.11765,-1.46545,2.49532,1.86736,-0.798439,1.55253,-0.179573,-1.62706,2.10368,-1.81677,-0.0757603,0.675256,-1.52082,-1.29023,0.0905291,-0.488113,-1.91316,0.793305,-0.685673,1.8581,0.19798,-1.68514,0.997209,-0.176766,1.49471,1.2782,-0.138632,0.37076,1.85013,-0.6728,1.60238,-1.00462,0.184891,1.77775,0.0477581,-0.680805,0.581603,-1.87566,-0.154333,-1.75393,-1.42262,-1.30681,-0.9392,-2.21091,-2.04404,0.32846,-2.13635,-1.49017,-1.9154,0.814721,-1.56643,-2.33579,-0.391837,-2.02013,0.121404,1.61234,-2.04606,-1.15175,1.50347,-2.48527,1.4724,-0.187629,-2.03446,1.00185,0.847442,-2.77771,1.07361,-1.44482,-2.46238]).reshape(points_shape);

# Dual graph and its faces
dual_neighbours   = array([5,4,3,2,1,-1,2,13,12,5,0,-1,3,14,13,1,0,-1,4,15,14,2,0,-1,5,16,15,3,0,-1,1,12,16,4,0,-1,7,11,10,31,27,-1,28,8,11,6,27,-1,29,9,11,7,28,-1,30,10,11,8,29,-1,31,6,11,9,30,-1,10,6,7,8,9,-1,13,18,17,16,5,1,2,14,19,18,12,1,3,15,20,19,13,2,4,16,21,20,14,3,5,12,17,21,15,4,18,23,22,21,16,12,13,19,24,23,17,12,14,20,25,24,18,13,15,21,26,25,19,14,16,17,22,26,20,15,23,28,27,26,21,17,18,24,29,28,22,17,19,25,30,29,23,18,20,26,31,30,24,19,21,22,27,31,25,20,28,7,6,31,26,22,23,29,8,7,27,22,24,30,9,8,28,23,25,31,10,9,29,24,26,27,6,10,30,25]).reshape(dual_neighbours_shape);

next_on_tri       = array([4,3,2,1,5,-1,13,12,5,0,2,-1,14,13,1,0,3,-1,15,14,2,0,4,-1,16,15,3,0,5,-1,12,16,4,0,1,-1,11,10,31,27,7,-1,8,11,6,27,28,-1,9,11,7,28,29,-1,10,11,8,29,30,-1,6,11,9,30,31,-1,6,7,8,9,10,-1,18,17,16,5,1,13,14,19,18,12,1,2,15,20,19,13,2,3,16,21,20,14,3,4,12,17,21,15,4,5,23,22,21,16,12,18,19,24,23,17,12,13,20,25,24,18,13,14,21,26,25,19,14,15,17,22,26,20,15,16,28,27,26,21,17,23,24,29,28,22,17,18,25,30,29,23,18,19,26,31,30,24,19,20,22,27,31,25,20,21,7,6,31,26,22,28,29,8,7,27,22,23,30,9,8,28,23,24,31,10,9,29,24,25,27,6,10,30,25,26]).reshape(dual_neighbours_shape);

triangles         = array([[[9,29,30],[6,31,27],[24,25,30],[7,27,28],[8,9,11],[18,19,24],[21,22,26],[25,26,31],[6,7,11],[5,12,16],[6,27,7],[9,30,10],[4,16,15],[1,2,13],[3,4,15],[0,1,5],[14,20,19],[0,4,3],[23,29,28],[8,29,9],[25,31,30],[2,3,14],[9,10,11],[0,5,4],[7,28,8],[17,18,23],[8,28,29],[12,17,16],[6,11,10],[6,10,31],[1,13,12],[13,14,19],[3,15,14],[2,14,13],[12,13,18],[12,18,17],[4,5,16],[7,8,11],[10,30,31],[15,16,21],[1,12,5],[15,21,20],[16,17,21],[0,3,2],[17,23,22],[17,22,21],[18,24,23],[24,30,29],[19,20,25],[13,19,18],[19,25,24],[20,21,26],[20,26,25],[22,23,28],[0,2,1],[22,28,27],[22,27,26],[26,27,31],[14,15,20],[23,24,29]]]).reshape(triangles_shape);

# prev_on_tri is the same as next_on_tri
unfolding_arcs   = [[[0,1],[0,2],[0,3],[0,4],[0,5],[1,0],[1,2],[1,5],[1,12],[1,13],[2,0],[2,1],[2,3],[2,13],[2,14],[3,0],[3,2],[3,4],[3,14],[3,15],[4,0],[4,3],[4,5],[4,15],[4,16],[5,0],[5,1],[5,4],[5,12],[5,16],[6,7],[6,10],[6,11],[6,27],[6,31],[7,6],[7,8],[7,11],[7,27],[7,28],[8,7],[8,9],[8,11],[8,28],[8,29],[9,8],[9,10],[9,11],[9,29],[9,30],[10,6],[10,9],[10,11],[10,30],[10,31],[11,6],[11,7],[11,8],[11,9],[11,10],[12,1],[12,5],[12,13],[12,16],[12,17],[12,18],[13,1],[13,2],[13,12],[13,14],[13,18],[13,19],[14,2],[14,3],[14,13],[14,15],[14,19],[14,20],[15,3],[15,4],[15,14],[15,16],[15,20],[15,21],[16,4],[16,5],[16,12],[16,15],[16,17],[16,21],[17,12],[17,16],[17,18],[17,21],[17,22],[17,23],[18,12],[18,13],[18,17],[18,19],[18,23],[18,24],[19,13],[19,14],[19,18],[19,20],[19,24],[19,25],[20,14],[20,15],[20,19],[20,21],[20,25],[20,26],[21,15],[21,16],[21,17],[21,20],[21,22],[21,26],[22,17],[22,21],[22,23],[22,26],[22,27],[22,28],[23,17],[23,18],[23,22],[23,24],[23,28],[23,29],[24,18],[24,19],[24,23],[24,25],[24,29],[24,30],[25,19],[25,20],[25,24],[25,26],[25,30],[25,31],[26,20],[26,21],[26,22],[26,25],[26,27],[26,31],[27,6],[27,7],[27,22],[27,26],[27,28],[27,31],[28,7],[28,8],[28,22],[28,23],[28,27],[28,29],[29,8],[29,9],[29,23],[29,24],[29,28],[29,30],[30,9],[30,10],[30,24],[30,25],[30,29],[30,31],[31,6],[31,10],[31,25],[31,26],[31,27],[31,30]]];
unfolding_arcpos = [[[[2,-3],[2,-2]],[[3,-3],[3,-2]],[[3,-3],[4,-3]],[[1,-3],[0,-2]],[[1,-3],[1,-2]],[[2,-2],[3,-3]],[[2,-2],[3,-2]],[[2,-2],[1,-2]],[[2,-2],[1,-1]],[[2,-2],[2,-1]],[[3,-2],[3,-3]],[[3,-2],[2,-2]],[[3,-2],[4,-2]],[[3,-2],[2,-1]],[[3,-2],[3,-1]],[[0,-3],[1,-3]],[[4,-3],[3,-2]],[[-1,-2],[0,-2]],[[4,-2],[3,-1]],[[4,-2],[4,-1]],[[0,-2],[1,-3]],[[0,-2],[0,-3]],[[0,-2],[1,-2]],[[0,-2],[-1,-1]],[[0,-2],[0,-1]],[[1,-2],[2,-3]],[[1,-2],[2,-2]],[[1,-2],[0,-2]],[[1,-2],[1,-1]],[[1,-2],[0,-1]],[[-3,3],[-2,3]],[[-3,3],[-4,3]],[[-3,3],[-3,4]],[[-3,3],[-2,2]],[[-3,3],[-3,2]],[[-2,3],[-3,3]],[[-2,3],[-1,3]],[[-2,3],[-3,4]],[[-2,3],[-2,2]],[[-2,3],[-1,2]],[[-1,3],[-2,3]],[[-1,3],[0,3]],[[-1,3],[-2,4]],[[-1,3],[-1,2]],[[-1,3],[0,2]],[[0,3],[-1,3]],[[0,3],[1,3]],[[0,3],[-1,4]],[[0,3],[0,2]],[[0,3],[1,2]],[[-4,4],[-3,3]],[[1,3],[0,3]],[[1,3],[0,4]],[[1,3],[1,2]],[[-4,3],[-3,2]],[[-3,4],[-3,3]],[[-2,4],[-2,3]],[[-1,4],[-1,3]],[[0,4],[0,3]],[[-3,4],[-4,4]],[[1,-1],[2,-2]],[[1,-1],[1,-2]],[[1,-1],[2,-1]],[[1,-1],[0,-1]],[[1,-1],[0,0]],[[1,-1],[1,0]],[[2,-1],[2,-2]],[[2,-1],[3,-2]],[[2,-1],[1,-1]],[[2,-1],[3,-1]],[[2,-1],[1,0]],[[2,-1],[2,0]],[[3,-1],[3,-2]],[[3,-1],[4,-2]],[[3,-1],[2,-1]],[[3,-1],[4,-1]],[[3,-1],[2,0]],[[3,-1],[3,0]],[[-1,-1],[-1,-2]],[[-1,-1],[0,-2]],[[4,-1],[3,-1]],[[-1,-1],[0,-1]],[[4,-1],[3,0]],[[-1,-1],[-1,0]],[[0,-1],[0,-2]],[[0,-1],[1,-2]],[[0,-1],[1,-1]],[[0,-1],[-1,-1]],[[0,-1],[0,0]],[[0,-1],[-1,0]],[[0,0],[1,-1]],[[0,0],[0,-1]],[[0,0],[1,0]],[[0,0],[-1,0]],[[0,0],[-1,1]],[[0,0],[0,1]],[[1,0],[1,-1]],[[1,0],[2,-1]],[[1,0],[0,0]],[[1,0],[2,0]],[[1,0],[0,1]],[[1,0],[1,1]],[[2,0],[2,-1]],[[2,0],[3,-1]],[[2,0],[1,0]],[[2,0],[3,0]],[[2,0],[1,1]],[[2,0],[2,1]],[[3,0],[3,-1]],[[-2,0],[-1,-1]],[[3,0],[2,0]],[[-2,0],[-1,0]],[[3,0],[2,1]],[[-2,0],[-2,1]],[[-1,0],[-1,-1]],[[-1,0],[0,-1]],[[-1,0],[0,0]],[[-1,0],[-2,0]],[[-1,0],[-1,1]],[[-1,0],[-2,1]],[[-1,1],[0,0]],[[-1,1],[-1,0]],[[-1,1],[0,1]],[[-1,1],[-2,1]],[[-1,1],[-2,2]],[[-1,1],[-1,2]],[[0,1],[0,0]],[[0,1],[1,0]],[[0,1],[-1,1]],[[0,1],[1,1]],[[0,1],[-1,2]],[[0,1],[0,2]],[[1,1],[1,0]],[[1,1],[2,0]],[[1,1],[0,1]],[[1,1],[2,1]],[[1,1],[0,2]],[[1,1],[1,2]],[[2,1],[2,0]],[[-3,1],[-2,0]],[[2,1],[1,1]],[[-3,1],[-2,1]],[[2,1],[1,2]],[[2,1],[2,2]],[[-2,1],[-2,0]],[[-2,1],[-1,0]],[[-2,1],[-1,1]],[[-2,1],[-3,1]],[[-2,1],[-2,2]],[[-2,1],[-3,2]],[[-2,2],[-3,3]],[[-2,2],[-2,3]],[[-2,2],[-1,1]],[[-2,2],[-2,1]],[[-2,2],[-1,2]],[[-2,2],[-3,2]],[[-1,2],[-2,3]],[[-1,2],[-1,3]],[[-1,2],[-1,1]],[[-1,2],[0,1]],[[-1,2],[-2,2]],[[-1,2],[0,2]],[[0,2],[-1,3]],[[0,2],[0,3]],[[0,2],[0,1]],[[0,2],[1,1]],[[0,2],[-1,2]],[[0,2],[1,2]],[[1,2],[0,3]],[[1,2],[1,3]],[[1,2],[1,1]],[[1,2],[2,1]],[[1,2],[0,2]],[[1,2],[2,2]],[[-3,2],[-3,3]],[[2,2],[1,3]],[[-3,2],[-3,1]],[[-3,2],[-2,1]],[[-3,2],[-2,2]],[[2,2],[1,2]]]];
unfolding_tripos = [[[[1,-3],[1,-2],[0,-2]],[[1,-3],[0,-2],[0,-3]],[[3,-3],[4,-3],[3,-2]],[[3,-3],[3,-2],[2,-2]],[[2,-3],[2,-2],[1,-2]],[[2,-2],[3,-2],[2,-1]],[[2,-2],[2,-1],[1,-1]],[[2,-2],[1,-1],[1,-2]],[[3,-2],[4,-2],[3,-1]],[[3,-2],[3,-1],[2,-1]],[[-1,-2],[0,-2],[-1,-1]],[[4,-2],[4,-1],[3,-1]],[[0,-2],[1,-2],[0,-1]],[[0,-2],[0,-1],[-1,-1]],[[1,-2],[1,-1],[0,-1]],[[-3,3],[-2,3],[-3,4]],[[-3,3],[-3,4],[-4,4]],[[-3,3],[-4,3],[-3,2]],[[-3,3],[-3,2],[-2,2]],[[-3,3],[-2,2],[-2,3]],[[-2,3],[-1,2],[-1,3]],[[-2,3],[-1,3],[-2,4]],[[-2,3],[-2,2],[-1,2]],[[-1,3],[0,2],[0,3]],[[-1,3],[0,3],[-1,4]],[[-1,3],[-1,2],[0,2]],[[0,3],[1,2],[1,3]],[[0,3],[1,3],[0,4]],[[0,3],[0,2],[1,2]],[[1,3],[1,2],[2,2]],[[1,-1],[2,-1],[1,0]],[[1,-1],[1,0],[0,0]],[[1,-1],[0,0],[0,-1]],[[2,-1],[3,-1],[2,0]],[[2,-1],[2,0],[1,0]],[[3,-1],[4,-1],[3,0]],[[3,-1],[3,0],[2,0]],[[-1,-1],[0,-1],[-1,0]],[[-1,-1],[-1,0],[-2,0]],[[0,-1],[0,0],[-1,0]],[[0,0],[1,0],[0,1]],[[0,0],[0,1],[-1,1]],[[0,0],[-1,1],[-1,0]],[[1,0],[2,0],[1,1]],[[1,0],[1,1],[0,1]],[[2,0],[3,0],[2,1]],[[2,0],[2,1],[1,1]],[[-2,0],[-1,0],[-2,1]],[[-2,0],[-2,1],[-3,1]],[[-1,0],[-1,1],[-2,1]],[[-1,1],[0,1],[-1,2]],[[-1,1],[-1,2],[-2,2]],[[-1,1],[-2,2],[-2,1]],[[0,1],[1,1],[0,2]],[[0,1],[0,2],[-1,2]],[[1,1],[2,1],[1,2]],[[1,1],[1,2],[0,2]],[[-3,1],[-2,1],[-3,2]],[[2,1],[2,2],[1,2]],[[-2,1],[-2,2],[-3,2]]]];
