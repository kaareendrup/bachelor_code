from numpy import array, nan
import numpy as np
import matplotlib.pyplot as plt

#%%

rspi_shape = [1,12];
neighbours_shape = [1,60,3];
points_shape     = [1,60,3];
dual_neighbours_shape = [1,32,6];
triangles_shape = [1,60,3];
rspi         = array([1,2,3,4,5,6,27,28,29,30,31,32]).reshape(rspi_shape);

# Cubic graph, its faces, and 3D embedding
cubic_neighbours  = array([4,12,1,0,10,2,1,8,3,2,5,4,3,7,0,3,9,6,5,15,7,6,14,4,2,11,9,8,18,5,1,13,11,10,20,8,0,14,13,12,22,10,7,17,12,6,19,16,15,25,17,16,24,14,9,21,19,18,28,15,11,23,21,20,30,18,13,24,23,22,32,20,17,27,22,16,29,26,25,35,27,26,34,24,19,31,29,28,38,25,21,33,31,30,40,28,23,34,33,32,42,30,27,37,32,26,39,36,35,45,37,36,44,34,29,41,39,38,48,35,31,43,41,40,50,38,33,44,43,42,52,40,37,47,42,36,49,46,45,55,47,46,54,44,39,51,49,48,57,45,41,53,51,50,58,48,43,54,53,52,59,50,47,56,52,46,57,56,55,59,54,49,58,55,51,59,57,53,56,58]).reshape(neighbours_shape);

pentagons    = array([[[0,1,2,3,4],[5,6,7,4,3],[8,9,5,3,2],[10,11,8,2,1],[12,13,10,1,0],[7,14,12,0,4],[55,56,54,47,46],[49,57,55,46,45],[51,58,57,49,48],[53,59,58,51,50],[54,56,59,53,52],[56,55,57,58,59]]]);

hexagons     = array([[[15,16,17,14,7,6],[9,18,19,15,6,5],[11,20,21,18,9,8],[13,22,23,20,11,10],[14,17,24,22,13,12],[25,26,27,24,17,16],[19,28,29,25,16,15],[21,30,31,28,19,18],[23,32,33,30,21,20],[24,27,34,32,23,22],[35,36,37,34,27,26],[29,38,39,35,26,25],[31,40,41,38,29,28],[33,42,43,40,31,30],[34,37,44,42,33,32],[45,46,47,44,37,36],[39,48,49,45,36,35],[41,50,51,48,39,38],[43,52,53,50,41,40],[44,47,54,52,43,42]]]);

next_on_face = array([7,13,2,12,11,3,10,9,4,8,6,0,5,14,1,2,18,7,9,16,4,15,12,3,1,20,5,11,19,3,0,22,8,13,21,2,4,17,10,14,23,1,6,24,0,5,28,17,19,26,14,25,22,7,8,30,15,21,29,6,10,32,18,23,31,9,12,27,20,24,33,11,16,34,13,15,38,27,29,36,24,35,32,17,18,40,25,31,39,16,20,42,28,33,41,19,22,37,30,34,43,21,26,44,23,25,48,37,39,46,34,45,42,27,28,50,35,41,49,26,30,52,38,43,51,29,32,47,40,44,53,31,36,54,33,35,57,47,49,56,44,55,52,37,38,58,45,51,55,36,40,59,48,53,57,39,42,56,50,54,58,41,46,59,43,45,58,54,57,53,47,48,59,46,50,56,49,52,55,51]).reshape(neighbours_shape);

prev_on_face = array([3,14,10,4,13,8,0,11,5,1,9,7,2,6,12,4,8,15,3,19,14,5,17,0,3,10,18,2,21,6,2,12,20,1,23,9,1,7,22,0,24,11,4,16,13,7,18,25,6,29,24,15,27,12,5,20,28,9,31,16,8,22,30,11,33,19,10,17,32,13,34,21,14,26,23,17,28,35,16,39,34,25,37,22,15,30,38,19,41,26,18,32,40,21,43,29,20,27,42,23,44,31,24,36,33,27,38,45,26,49,44,35,47,32,25,40,48,29,51,36,28,42,50,31,53,39,30,37,52,33,54,41,34,46,43,37,48,55,36,57,54,45,56,42,35,50,57,39,58,46,38,52,58,41,59,49,40,47,59,43,56,51,44,55,53,47,49,59,46,58,52,45,51,56,48,53,55,50,54,57]).reshape(neighbours_shape);

face_right   = array([5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,5,6,6,5,6,5,5,5,6,5,6,6,5,5,6,5,6,6,5,5,6,5,6,6,5,6,6,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,5,6,5,5,6,5,6,6,6,5,6,5,5,6,6,5,6,5,5,6,6,5,6,5,5,6,5,5,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5]).reshape(neighbours_shape);

points_start = array([2.79681,0.516113,13.0222,6.76514,0.57774,11.7327,8.34022,6.05953,9.27994,2.64001,6.2555,11.7327,1.35511,2.50044,13.0222,0.236745,9.93523,9.27994,-3.99592,4.32595,11.7327,-0.977597,1.74249,13.0222,10.3245,7.50122,5.90401,3.56292,12.0524,5.90401,9.52212,-2.845,9.27994,12.5636,-0.33587,5.90401,1.35511,-1.46821,13.0222,2.87942,-5.13714,11.7327,-0.977597,-0.710266,13.0222,-7.8136,4.55172,9.27994,-8.32628,-2.18262,9.27994,-4.1883,-3.04298,11.7327,4.78525,13.0433,1.93536,-9.95789,5.75179,5.90401,13.8836,0.520443,1.93536,11.3678,8.25916,-2.23752,1.91441,-8.83773,9.27994,2.39312,-11.2479,5.90401,-4.64875,-7.24429,9.27994,-10.2297,-4.12493,5.90401,-9.94703,-7.22694,1.93536,-7.08419,-8.45433,5.90401,-8.81305,9.61773,1.93536,-12.4509,1.07726,1.93536,10.3245,7.50122,-6.20616,-1.83775,13.4406,-2.23752,6.42363,-11.3537,1.93536,12.2149,-5.90118,-2.23752,-2.82302,-12.1744,1.93536,-9.94703,-7.22694,-2.23752,-6.1621,-9.1789,-6.20616,-4.03965,-11.771,-2.23752,-12.4432,-0.204508,-2.23752,-10.6338,-3.02406,-6.20616,-1.00605,12.2753,-6.20616,-10.0767,5.50252,-6.20616,11.3636,-4.75008,-6.20616,8.34022,6.05953,-9.5821,2.11935,-11.2838,-6.20616,-3.35451,-7.99393,-9.5821,1.02313,-5.53089,-12.0349,7.23486,-6.29382,-9.5821,-8.63928,-0.720068,-9.5821,-4.1883,-3.04298,-12.0349,-3.75008,8.82565,-9.5821,-4.94402,2.6822,-12.0349,5.60904,4.0752,-12.0349,1.67334,6.49413,-12.0349,6.69338,-0.415353,-12.0349,1.30866,-1.48271,-13.3243,2.79531,0.595135,-13.3243,-0.977597,-0.710266,-13.3243,-1.00574,1.70279,-13.3243,1.42981,2.47459,-13.3243]).reshape(points_shape);

points_opt   = array([0.780063,-0.387561,5.83873,2.1445,0.0840456,5.48188,2.08295,1.55533,5.27639,0.678184,1.9902,5.49516,-0.126053,0.789559,5.84336,0.158229,2.54625,4.22158,-1.05294,1.73839,3.85569,-1.15135,0.589607,4.78901,2.44701,1.84716,3.86668,1.29275,2.60195,3.27194,2.53659,-0.549774,4.19863,2.85849,0.565123,3.24808,0.318942,-1.32451,4.78397,1.46765,-1.51359,3.84491,-0.96442,-0.79863,4.2583,-1.13528,1.37212,2.50301,-1.54449,0.121045,2.06366,-1.09613,-0.898609,2.8836,0.922913,2.18908,1.98754,-0.377324,2.00752,1.57472,2.33366,0.40909,1.96202,1.75702,1.43068,1.24372,1.11765,-1.46545,2.49532,1.86736,-0.798439,1.55253,-0.179573,-1.62706,2.10368,-1.81677,-0.0757603,0.675256,-1.52082,-1.29023,0.0905291,-0.488113,-1.91316,0.793305,-0.685673,1.8581,0.19798,-1.68514,0.997209,-0.176766,1.49471,1.2782,-0.138632,0.37076,1.85013,-0.6728,1.60238,-1.00462,0.184891,1.77775,0.0477581,-0.680805,0.581603,-1.87566,-0.154333,-1.75393,-1.42262,-1.30681,-0.9392,-2.21091,-2.04404,0.32846,-2.13635,-1.49017,-1.9154,0.814721,-1.56643,-2.33579,-0.391837,-2.02013,0.121404,1.61234,-2.04606,-1.15175,1.50347,-2.48527,1.4724,-0.187629,-2.03446,1.00185,0.847442,-2.77771,1.07361,-1.44482,-2.46238,-1.31482,-2.57904,-3.33999,-0.15453,-2.5473,-4.26024,1.03883,-1.79626,-3.8202,-2.8303,-0.497911,-3.32468,-2.41872,-1.7891,-3.95293,-1.39838,1.57384,-3.86137,-2.46861,0.608131,-4.25548,1.02313,0.755736,-4.16756,-0.2224,1.34168,-4.74858,1.20045,-0.612316,-4.72039,-0.621073,-1.95159,-5.53606,0.221181,-0.764873,-5.82506,-2.01922,-1.48778,-5.34832,-2.04411,-0.0144497,-5.534,-0.660166,0.431932,-5.83441]).reshape(points_shape);

# Dual graph and its faces
dual_neighbours   = array([5,4,3,2,1,-1,2,7,6,5,0,-1,3,8,7,1,0,-1,4,9,8,2,0,-1,5,10,9,3,0,-1,1,6,10,4,0,-1,7,12,11,10,5,1,2,8,13,12,6,1,3,9,14,13,7,2,4,10,15,14,8,3,5,6,11,15,9,4,12,17,16,15,10,6,7,13,18,17,11,6,8,14,19,18,12,7,9,15,20,19,13,8,10,11,16,20,14,9,17,22,21,20,15,11,12,18,23,22,16,11,13,19,24,23,17,12,14,20,25,24,18,13,15,16,21,25,19,14,22,27,26,25,20,16,17,23,28,27,21,16,18,24,29,28,22,17,19,25,30,29,23,18,20,21,26,30,24,19,27,31,30,25,21,-1,22,28,31,26,21,-1,23,29,31,27,22,-1,24,30,31,28,23,-1,25,26,31,29,24,-1,30,26,27,28,29,-1]).reshape(dual_neighbours_shape);

next_on_tri       = array([4,3,2,1,5,-1,7,6,5,0,2,-1,8,7,1,0,3,-1,9,8,2,0,4,-1,10,9,3,0,5,-1,6,10,4,0,1,-1,12,11,10,5,1,7,8,13,12,6,1,2,9,14,13,7,2,3,10,15,14,8,3,4,6,11,15,9,4,5,17,16,15,10,6,12,13,18,17,11,6,7,14,19,18,12,7,8,15,20,19,13,8,9,11,16,20,14,9,10,22,21,20,15,11,17,18,23,22,16,11,12,19,24,23,17,12,13,20,25,24,18,13,14,16,21,25,19,14,15,27,26,25,20,16,22,23,28,27,21,16,17,24,29,28,22,17,18,25,30,29,23,18,19,21,26,30,24,19,20,31,30,25,21,27,-1,28,31,26,21,22,-1,29,31,27,22,23,-1,30,31,28,23,24,-1,26,31,29,24,25,-1,26,27,28,29,30,-1]).reshape(dual_neighbours_shape);

triangles         = array([[[0,5,4],[0,4,3],[0,3,2],[0,2,1],[0,1,5],[1,2,7],[1,7,6],[1,6,5],[2,3,8],[2,8,7],[3,4,9],[3,9,8],[4,5,10],[4,10,9],[5,6,10],[6,7,12],[6,12,11],[6,11,10],[7,8,13],[7,13,12],[8,9,14],[8,14,13],[9,10,15],[9,15,14],[10,11,15],[11,12,17],[11,17,16],[11,16,15],[12,13,18],[12,18,17],[13,14,19],[13,19,18],[14,15,20],[14,20,19],[15,16,20],[16,17,22],[16,22,21],[16,21,20],[17,18,23],[17,23,22],[18,19,24],[18,24,23],[19,20,25],[19,25,24],[20,21,25],[21,22,27],[21,27,26],[21,26,25],[22,23,28],[22,28,27],[23,24,29],[23,29,28],[24,25,30],[24,30,29],[25,26,30],[26,27,31],[26,31,30],[27,28,31],[28,29,31],[29,30,31]]]).reshape(triangles_shape);

# prev_on_tri is the same as next_on_tri
unfolding_arcs   = [[[0,1],[0,4],[0,12],[0,88],[0,90],[0,91],[1,0],[1,2],[1,10],[1,86],[1,88],[1,90],[2,1],[2,3],[2,8],[2,85],[2,86],[2,88],[3,2],[3,4],[3,5],[3,84],[3,85],[3,88],[4,0],[4,3],[4,7],[4,84],[4,88],[4,91],[5,3],[5,6],[5,9],[5,83],[5,84],[5,85],[6,5],[6,7],[6,15],[6,83],[6,84],[6,89],[7,4],[7,6],[7,14],[7,84],[7,89],[7,91],[8,2],[8,9],[8,11],[8,82],[8,85],[8,86],[9,5],[9,8],[9,18],[9,82],[9,83],[9,85],[10,1],[10,11],[10,13],[10,81],[10,86],[10,90],[11,8],[11,10],[11,20],[11,81],[11,82],[11,86],[12,0],[12,13],[12,14],[12,87],[12,90],[12,91],[13,10],[13,12],[13,22],[13,81],[13,87],[13,90],[14,7],[14,12],[14,17],[14,87],[14,89],[14,91],[15,6],[15,16],[15,19],[15,80],[15,83],[15,89],[16,15],[16,17],[16,25],[16,79],[16,80],[16,89],[17,14],[17,16],[17,24],[17,79],[17,87],[17,89],[18,9],[18,19],[18,21],[18,78],[18,82],[18,83],[19,15],[19,18],[19,28],[19,78],[19,80],[19,83],[20,11],[20,21],[20,23],[20,76],[20,81],[20,82],[21,18],[21,20],[21,30],[21,76],[21,78],[21,82],[22,13],[22,23],[22,24],[22,75],[22,81],[22,87],[23,20],[23,22],[23,32],[23,75],[23,76],[23,81],[24,17],[24,22],[24,27],[24,75],[24,79],[24,87],[25,16],[25,26],[25,29],[25,74],[25,79],[25,80],[26,25],[26,27],[26,35],[26,73],[26,74],[26,79],[27,24],[27,26],[27,34],[27,73],[27,75],[27,79],[28,19],[28,29],[28,31],[28,72],[28,78],[28,80],[29,25],[29,28],[29,38],[29,72],[29,74],[29,80],[30,21],[30,31],[30,33],[30,71],[30,76],[30,78],[31,28],[31,30],[31,40],[31,71],[31,72],[31,78],[32,23],[32,33],[32,34],[32,70],[32,75],[32,76],[33,30],[33,32],[33,42],[33,70],[33,71],[33,76],[34,27],[34,32],[34,37],[34,70],[34,73],[34,75],[35,26],[35,36],[35,39],[35,69],[35,73],[35,74],[36,35],[36,37],[36,45],[36,68],[36,69],[36,73],[37,34],[37,36],[37,44],[37,68],[37,70],[37,73],[38,29],[38,39],[38,41],[38,67],[38,72],[38,74],[39,35],[39,38],[39,48],[39,67],[39,69],[39,74],[40,31],[40,41],[40,43],[40,66],[40,71],[40,72],[41,38],[41,40],[41,50],[41,66],[41,67],[41,72],[42,33],[42,43],[42,44],[42,70],[42,71],[42,77],[43,40],[43,42],[43,52],[43,66],[43,71],[43,77],[44,37],[44,42],[44,47],[44,68],[44,70],[44,77],[45,36],[45,46],[45,49],[45,65],[45,68],[45,69],[46,45],[46,47],[46,55],[46,64],[46,65],[46,68],[47,44],[47,46],[47,54],[47,64],[47,68],[47,77],[48,39],[48,49],[48,51],[48,63],[48,67],[48,69],[49,45],[49,48],[49,57],[49,63],[49,65],[49,69],[50,41],[50,51],[50,53],[50,62],[50,66],[50,67],[51,48],[51,50],[51,58],[51,62],[51,63],[51,67],[52,43],[52,53],[52,54],[52,61],[52,66],[52,77],[53,50],[53,52],[53,59],[53,61],[53,62],[53,66],[54,47],[54,52],[54,56],[54,61],[54,64],[54,77],[55,46],[55,56],[55,57],[55,60],[55,64],[55,65],[56,54],[56,55],[56,59],[56,60],[56,61],[56,64],[57,49],[57,55],[57,58],[57,60],[57,63],[57,65],[58,51],[58,57],[58,59],[58,60],[58,62],[58,63],[59,53],[59,56],[59,58],[59,60],[59,61],[59,62],[60,55],[60,56],[60,57],[60,58],[60,59],[61,52],[61,53],[61,54],[61,56],[61,59],[62,50],[62,51],[62,53],[62,58],[62,59],[63,48],[63,49],[63,51],[63,57],[63,58],[64,46],[64,47],[64,54],[64,55],[64,56],[65,45],[65,46],[65,49],[65,55],[65,57],[66,40],[66,41],[66,43],[66,50],[66,52],[66,53],[67,38],[67,39],[67,41],[67,48],[67,50],[67,51],[68,36],[68,37],[68,44],[68,45],[68,46],[68,47],[69,35],[69,36],[69,39],[69,45],[69,48],[69,49],[70,32],[70,33],[70,34],[70,37],[70,42],[70,44],[71,30],[71,31],[71,33],[71,40],[71,42],[71,43],[72,28],[72,29],[72,31],[72,38],[72,40],[72,41],[73,26],[73,27],[73,34],[73,35],[73,36],[73,37],[74,25],[74,26],[74,29],[74,35],[74,38],[74,39],[75,22],[75,23],[75,24],[75,27],[75,32],[75,34],[76,20],[76,21],[76,23],[76,30],[76,32],[76,33],[77,42],[77,43],[77,44],[77,47],[77,52],[77,54],[78,18],[78,19],[78,21],[78,28],[78,30],[78,31],[79,16],[79,17],[79,24],[79,25],[79,26],[79,27],[80,15],[80,16],[80,19],[80,25],[80,28],[80,29],[81,10],[81,11],[81,13],[81,20],[81,22],[81,23],[82,8],[82,9],[82,11],[82,18],[82,20],[82,21],[83,5],[83,6],[83,9],[83,15],[83,18],[83,19],[84,3],[84,4],[84,5],[84,6],[84,7],[85,2],[85,3],[85,5],[85,8],[85,9],[86,1],[86,2],[86,8],[86,10],[86,11],[87,12],[87,13],[87,14],[87,17],[87,22],[87,24],[88,0],[88,1],[88,2],[88,3],[88,4],[89,6],[89,7],[89,14],[89,15],[89,16],[89,17],[90,0],[90,1],[90,10],[90,12],[90,13],[91,0],[91,4],[91,7],[91,12],[91,14]]];
unfolding_arcpos = [[[[1,4],[1,5]],[[1,4],[0,4]],[[2,3],[2,2]],[[1,4],[0,5]],[[2,3],[3,2]],[[2,3],[1,3]],[[3,3],[2,3]],[[1,5],[0,6]],[[4,2],[4,1]],[[1,5],[1,6]],[[1,5],[0,5]],[[4,2],[3,2]],[[0,6],[1,5]],[[-1,6],[-1,5]],[[-4,6],[-4,5]],[[-3,6],[-3,5]],[[-4,6],[-5,6]],[[0,6],[0,5]],[[-2,5],[-3,6]],[[-1,5],[0,4]],[[-2,5],[-2,4]],[[-1,5],[-1,4]],[[-2,5],[-3,5]],[[-1,5],[0,5]],[[0,4],[1,4]],[[0,4],[-1,5]],[[0,4],[0,3]],[[0,4],[-1,4]],[[0,4],[0,5]],[[0,4],[1,3]],[[-2,4],[-2,5]],[[-2,4],[-1,3]],[[-2,4],[-3,4]],[[-2,4],[-2,3]],[[-2,4],[-1,4]],[[-2,4],[-3,5]],[[-1,3],[-2,4]],[[-1,3],[0,3]],[[-1,3],[-1,2]],[[-1,3],[-2,3]],[[-1,3],[-1,4]],[[-1,3],[0,2]],[[0,3],[0,4]],[[0,3],[-1,3]],[[0,3],[1,2]],[[0,3],[-1,4]],[[0,3],[0,2]],[[0,3],[1,3]],[[-4,5],[-4,6]],[[-4,5],[-3,4]],[[-4,5],[-5,5]],[[-4,5],[-4,4]],[[-4,5],[-3,5]],[[-4,5],[-5,6]],[[-3,4],[-2,4]],[[-3,4],[-4,5]],[[-3,4],[-3,3]],[[-3,4],[-4,4]],[[-3,4],[-2,3]],[[-3,4],[-3,5]],[[4,1],[4,2]],[[4,1],[5,0]],[[4,1],[3,1]],[[4,1],[4,0]],[[4,1],[5,1]],[[4,1],[3,2]],[[-5,5],[-4,5]],[[5,0],[4,1]],[[5,0],[5,-1]],[[5,0],[4,0]],[[-5,5],[-4,4]],[[5,0],[5,1]],[[2,2],[2,3]],[[2,2],[3,1]],[[2,2],[1,2]],[[2,2],[2,1]],[[2,2],[3,2]],[[2,2],[1,3]],[[3,1],[4,1]],[[3,1],[2,2]],[[3,1],[3,0]],[[3,1],[4,0]],[[3,1],[2,1]],[[3,1],[3,2]],[[1,2],[0,3]],[[1,2],[2,2]],[[1,2],[1,1]],[[1,2],[2,1]],[[1,2],[0,2]],[[1,2],[1,3]],[[-1,2],[-1,3]],[[-1,2],[0,1]],[[-1,2],[-2,2]],[[-1,2],[-1,1]],[[-1,2],[-2,3]],[[-1,2],[0,2]],[[0,1],[-1,2]],[[0,1],[1,1]],[[0,1],[0,0]],[[0,1],[1,0]],[[0,1],[-1,1]],[[0,1],[0,2]],[[1,1],[1,2]],[[1,1],[0,1]],[[1,1],[2,0]],[[1,1],[1,0]],[[1,1],[2,1]],[[1,1],[0,2]],[[-3,3],[-3,4]],[[-3,3],[-2,2]],[[-3,3],[-4,3]],[[-3,3],[-3,2]],[[-3,3],[-4,4]],[[-3,3],[-2,3]],[[-2,2],[-1,2]],[[-2,2],[-3,3]],[[-2,2],[-2,1]],[[-2,2],[-3,2]],[[-2,2],[-1,1]],[[-2,2],[-2,3]],[[5,-1],[5,0]],[[-5,4],[-4,3]],[[5,-1],[4,-1]],[[5,-1],[5,-2]],[[5,-1],[4,0]],[[5,-1],[6,-1]],[[-4,3],[-3,3]],[[6,-2],[5,-1]],[[-4,3],[-4,2]],[[-4,3],[-5,3]],[[-4,3],[-3,2]],[[-4,3],[-4,4]],[[3,0],[3,1]],[[3,0],[4,-1]],[[3,0],[2,0]],[[3,0],[3,-1]],[[3,0],[4,0]],[[3,0],[2,1]],[[4,-1],[5,-1]],[[4,-1],[3,0]],[[4,-1],[4,-2]],[[4,-1],[3,-1]],[[4,-1],[5,-2]],[[4,-1],[4,0]],[[2,0],[1,1]],[[2,0],[3,0]],[[2,0],[2,-1]],[[2,0],[3,-1]],[[2,0],[1,0]],[[2,0],[2,1]],[[0,0],[0,1]],[[0,0],[1,-1]],[[0,0],[-1,0]],[[0,0],[0,-1]],[[0,0],[1,0]],[[0,0],[-1,1]],[[1,-1],[0,0]],[[1,-1],[2,-1]],[[1,-1],[1,-2]],[[1,-1],[2,-2]],[[1,-1],[0,-1]],[[1,-1],[1,0]],[[2,-1],[2,0]],[[2,-1],[1,-1]],[[2,-1],[3,-2]],[[2,-1],[2,-2]],[[2,-1],[3,-1]],[[2,-1],[1,0]],[[-2,1],[-2,2]],[[-2,1],[-1,0]],[[-2,1],[-3,1]],[[-2,1],[-2,0]],[[-2,1],[-3,2]],[[-2,1],[-1,1]],[[-1,0],[0,0]],[[-1,0],[-2,1]],[[-1,0],[-1,-1]],[[-1,0],[-2,0]],[[-1,0],[0,-1]],[[-1,0],[-1,1]],[[-4,2],[-4,3]],[[-4,2],[-3,1]],[[-4,2],[-5,2]],[[-4,2],[-4,1]],[[6,-3],[5,-2]],[[-4,2],[-3,2]],[[-3,1],[-2,1]],[[-3,1],[-4,2]],[[-3,1],[-3,0]],[[-3,1],[-4,1]],[[-3,1],[-2,0]],[[-3,1],[-3,2]],[[4,-2],[4,-1]],[[4,-2],[5,-3]],[[4,-2],[3,-2]],[[4,-2],[4,-3]],[[4,-2],[3,-1]],[[4,-2],[5,-2]],[[5,-3],[6,-3]],[[5,-3],[4,-2]],[[5,-3],[5,-4]],[[5,-3],[4,-3]],[[-5,2],[-4,1]],[[5,-3],[5,-2]],[[3,-2],[2,-1]],[[3,-2],[4,-2]],[[3,-2],[3,-3]],[[3,-2],[4,-3]],[[3,-2],[2,-2]],[[3,-2],[3,-1]],[[1,-2],[1,-1]],[[1,-2],[2,-3]],[[1,-2],[0,-2]],[[1,-2],[1,-3]],[[1,-2],[2,-2]],[[1,-2],[0,-1]],[[2,-3],[1,-2]],[[2,-3],[3,-3]],[[2,-3],[2,-4]],[[2,-3],[3,-4]],[[2,-3],[1,-3]],[[2,-3],[2,-2]],[[3,-3],[3,-2]],[[3,-3],[2,-3]],[[3,-3],[4,-4]],[[3,-3],[3,-4]],[[3,-3],[4,-3]],[[3,-3],[2,-2]],[[-1,-1],[-1,0]],[[-1,-1],[0,-2]],[[-1,-1],[-2,-1]],[[-1,-1],[-1,-2]],[[-1,-1],[-2,0]],[[-1,-1],[0,-1]],[[0,-2],[1,-2]],[[0,-2],[-1,-1]],[[0,-2],[0,-3]],[[0,-2],[-1,-2]],[[0,-2],[1,-3]],[[0,-2],[0,-1]],[[-3,0],[-3,1]],[[-3,0],[-2,-1]],[[-3,0],[-4,0]],[[-3,0],[-3,-1]],[[-3,0],[-4,1]],[[-3,0],[-2,0]],[[-2,-1],[-1,-1]],[[-2,-1],[-3,0]],[[-2,-1],[-2,-2]],[[-2,-1],[-3,-1]],[[-2,-1],[-1,-2]],[[-2,-1],[-2,0]],[[5,-4],[5,-3]],[[-5,1],[-4,0]],[[5,-4],[4,-4]],[[5,-4],[4,-3]],[[5,-4],[6,-4]],[[5,-4],[5,-5]],[[-4,0],[-3,0]],[[6,-5],[5,-4]],[[-4,0],[-4,-1]],[[-4,0],[-3,-1]],[[-4,0],[-4,1]],[[6,-5],[5,-5]],[[4,-4],[3,-3]],[[4,-4],[5,-4]],[[4,-4],[4,-5]],[[4,-4],[3,-4]],[[4,-4],[4,-3]],[[4,-4],[5,-5]],[[2,-4],[2,-3]],[[2,-4],[3,-5]],[[2,-4],[1,-4]],[[2,-4],[2,-5]],[[2,-4],[3,-4]],[[2,-4],[1,-3]],[[3,-5],[2,-4]],[[3,-5],[4,-5]],[[3,-5],[3,-6]],[[3,-5],[4,-6]],[[3,-5],[2,-5]],[[3,-5],[3,-4]],[[4,-5],[4,-4]],[[4,-5],[3,-5]],[[4,-5],[5,-6]],[[4,-5],[4,-6]],[[4,-5],[3,-4]],[[4,-5],[5,-5]],[[0,-3],[0,-2]],[[0,-3],[1,-4]],[[0,-3],[-1,-3]],[[0,-3],[0,-4]],[[0,-3],[-1,-2]],[[0,-3],[1,-3]],[[1,-4],[2,-4]],[[1,-4],[0,-3]],[[1,-4],[1,-5]],[[1,-4],[0,-4]],[[1,-4],[2,-5]],[[1,-4],[1,-3]],[[-2,-2],[-2,-1]],[[-2,-2],[-1,-3]],[[-2,-2],[-3,-2]],[[-2,-2],[-2,-3]],[[-2,-2],[-3,-1]],[[-2,-2],[-1,-2]],[[-1,-3],[0,-3]],[[-1,-3],[-2,-2]],[[-1,-3],[-1,-4]],[[-1,-3],[-2,-3]],[[-1,-3],[0,-4]],[[-1,-3],[-1,-2]],[[6,-6],[6,-5]],[[-4,-1],[-3,-2]],[[6,-6],[5,-6]],[[-4,-1],[-4,-2]],[[-4,-1],[-3,-1]],[[6,-6],[5,-5]],[[-3,-2],[-2,-2]],[[-3,-2],[-4,-1]],[[-3,-2],[-3,-3]],[[-3,-2],[-4,-2]],[[-3,-2],[-2,-3]],[[-3,-2],[-3,-1]],[[5,-6],[4,-5]],[[5,-6],[6,-6]],[[5,-6],[5,-7]],[[5,-6],[6,-7]],[[5,-6],[4,-6]],[[5,-6],[5,-5]],[[3,-6],[3,-5]],[[3,-6],[4,-7]],[[2,-6],[1,-5]],[[2,-6],[1,-6]],[[3,-6],[4,-6]],[[2,-6],[2,-5]],[[5,-7],[5,-6]],[[2,-7],[2,-6]],[[1,-7],[0,-6]],[[1,-7],[1,-6]],[[5,-7],[6,-7]],[[4,-7],[4,-6]],[[1,-5],[1,-4]],[[1,-5],[2,-6]],[[1,-5],[0,-5]],[[1,-5],[1,-6]],[[1,-5],[0,-4]],[[1,-5],[2,-5]],[[-1,-4],[-1,-3]],[[0,-5],[1,-5]],[[0,-5],[0,-6]],[[0,-5],[1,-6]],[[-1,-4],[-2,-3]],[[-1,-4],[0,-4]],[[-3,-3],[-3,-2]],[[0,-6],[1,-7]],[[-2,-4],[-1,-4]],[[0,-6],[1,-6]],[[0,-6],[0,-7]],[[-3,-3],[-2,-3]],[[1,-6],[2,-6]],[[1,-6],[2,-7]],[[1,-6],[1,-5]],[[1,-6],[0,-5]],[[1,-6],[0,-6]],[[6,-7],[6,-6]],[[-4,-2],[-3,-2]],[[6,-7],[5,-6]],[[0,-7],[1,-7]],[[-4,-2],[-3,-3]],[[-2,-3],[-2,-2]],[[-2,-3],[-1,-3]],[[-2,-3],[-3,-2]],[[-2,-3],[-1,-4]],[[-2,-3],[-2,-4]],[[0,-4],[0,-3]],[[0,-4],[1,-4]],[[0,-4],[-1,-3]],[[0,-4],[1,-5]],[[0,-4],[0,-5]],[[4,-6],[3,-5]],[[4,-6],[4,-5]],[[4,-6],[5,-6]],[[4,-6],[3,-6]],[[4,-6],[5,-7]],[[2,-5],[2,-4]],[[2,-5],[3,-5]],[[2,-5],[1,-4]],[[2,-5],[3,-6]],[[2,-5],[1,-5]],[[-3,-1],[-3,0]],[[-3,-1],[-2,-1]],[[-3,-1],[-4,0]],[[-3,-1],[-2,-2]],[[-3,-1],[-4,-1]],[[-3,-1],[-3,-2]],[[-1,-2],[-1,-1]],[[-1,-2],[0,-2]],[[-1,-2],[-2,-1]],[[-1,-2],[0,-3]],[[-1,-2],[-2,-2]],[[-1,-2],[-1,-3]],[[3,-4],[2,-3]],[[3,-4],[3,-3]],[[3,-4],[4,-4]],[[3,-4],[2,-4]],[[3,-4],[3,-5]],[[3,-4],[4,-5]],[[1,-3],[1,-2]],[[1,-3],[2,-3]],[[1,-3],[0,-2]],[[1,-3],[2,-4]],[[1,-3],[0,-3]],[[1,-3],[1,-4]],[[4,-3],[4,-2]],[[4,-3],[5,-3]],[[4,-3],[3,-2]],[[4,-3],[3,-3]],[[4,-3],[5,-4]],[[4,-3],[4,-4]],[[-4,1],[-4,2]],[[-4,1],[-3,1]],[[6,-4],[5,-3]],[[-4,1],[-3,0]],[[-4,1],[-5,1]],[[-4,1],[-4,0]],[[-2,0],[-2,1]],[[-2,0],[-1,0]],[[-2,0],[-3,1]],[[-2,0],[-1,-1]],[[-2,0],[-3,0]],[[-2,0],[-2,-1]],[[2,-2],[1,-1]],[[2,-2],[2,-1]],[[2,-2],[3,-2]],[[2,-2],[1,-2]],[[2,-2],[2,-3]],[[2,-2],[3,-3]],[[0,-1],[0,0]],[[0,-1],[1,-1]],[[0,-1],[-1,0]],[[0,-1],[1,-2]],[[0,-1],[-1,-1]],[[0,-1],[0,-2]],[[3,-1],[3,0]],[[3,-1],[4,-1]],[[3,-1],[2,0]],[[3,-1],[2,-1]],[[3,-1],[4,-2]],[[3,-1],[3,-2]],[[5,-2],[5,-1]],[[5,-2],[6,-2]],[[5,-2],[4,-1]],[[-5,3],[-4,2]],[[5,-2],[4,-2]],[[5,-2],[5,-3]],[[5,-5],[5,-4]],[[5,-5],[6,-5]],[[5,-5],[4,-4]],[[5,-5],[4,-5]],[[5,-5],[6,-6]],[[5,-5],[5,-6]],[[-3,2],[-3,3]],[[-3,2],[-2,2]],[[-3,2],[-4,3]],[[-3,2],[-2,1]],[[-3,2],[-4,2]],[[-3,2],[-3,1]],[[1,0],[0,1]],[[1,0],[1,1]],[[1,0],[2,0]],[[1,0],[0,0]],[[1,0],[1,-1]],[[1,0],[2,-1]],[[-1,1],[-1,2]],[[-1,1],[0,1]],[[-1,1],[-2,2]],[[-1,1],[0,0]],[[-1,1],[-2,1]],[[-1,1],[-1,0]],[[4,0],[4,1]],[[4,0],[5,0]],[[4,0],[3,1]],[[4,0],[5,-1]],[[4,0],[3,0]],[[4,0],[4,-1]],[[-4,4],[-4,5]],[[-4,4],[-3,4]],[[6,-1],[5,0]],[[-4,4],[-3,3]],[[-4,4],[-5,4]],[[-4,4],[-4,3]],[[-2,3],[-2,4]],[[-2,3],[-1,3]],[[-2,3],[-3,4]],[[-2,3],[-1,2]],[[-2,3],[-3,3]],[[-2,3],[-2,2]],[[-1,4],[-2,5]],[[-1,4],[0,4]],[[-1,4],[-2,4]],[[-1,4],[-1,3]],[[-1,4],[0,3]],[[-3,5],[-4,6]],[[-3,5],[-2,5]],[[-3,5],[-2,4]],[[-3,5],[-4,5]],[[-3,5],[-3,4]],[[5,1],[4,2]],[[1,6],[0,6]],[[-5,6],[-4,5]],[[5,1],[4,1]],[[-5,6],[-5,5]],[[2,1],[2,2]],[[2,1],[3,1]],[[2,1],[1,2]],[[2,1],[1,1]],[[2,1],[3,0]],[[2,1],[2,0]],[[0,5],[1,4]],[[0,5],[1,5]],[[0,5],[-1,6]],[[0,5],[-1,5]],[[0,5],[0,4]],[[0,2],[-1,3]],[[0,2],[0,3]],[[0,2],[1,2]],[[0,2],[-1,2]],[[0,2],[0,1]],[[0,2],[1,1]],[[3,2],[2,3]],[[3,2],[3,3]],[[3,2],[4,1]],[[3,2],[2,2]],[[3,2],[3,1]],[[1,3],[1,4]],[[1,3],[0,4]],[[1,3],[0,3]],[[1,3],[2,2]],[[1,3],[1,2]]]];
unfolding_tripos = [[[[1,4],[0,5],[0,4]],[[1,4],[0,4],[1,3]],[[2,3],[1,3],[2,2]],[[2,3],[2,2],[3,2]],[[2,3],[3,2],[3,3]],[[1,4],[1,5],[0,5]],[[4,2],[3,2],[4,1]],[[4,2],[4,1],[5,1]],[[1,5],[1,6],[0,6]],[[1,5],[0,6],[0,5]],[[-4,6],[-5,6],[-4,5]],[[-4,6],[-4,5],[-3,5]],[[-3,6],[-3,5],[-2,5]],[[-1,6],[-1,5],[0,5]],[[-2,5],[-3,5],[-2,4]],[[-2,5],[-2,4],[-1,4]],[[-1,5],[-1,4],[0,4]],[[-1,5],[0,4],[0,5]],[[0,4],[-1,4],[0,3]],[[0,4],[0,3],[1,3]],[[-2,4],[-3,5],[-3,4]],[[-2,4],[-3,4],[-2,3]],[[-2,4],[-2,3],[-1,3]],[[-2,4],[-1,3],[-1,4]],[[-1,3],[-2,3],[-1,2]],[[-1,3],[-1,2],[0,2]],[[-1,3],[0,2],[0,3]],[[-1,3],[0,3],[-1,4]],[[0,3],[0,2],[1,2]],[[0,3],[1,2],[1,3]],[[-4,5],[-5,6],[-5,5]],[[-4,5],[-5,5],[-4,4]],[[-4,5],[-4,4],[-3,4]],[[-4,5],[-3,4],[-3,5]],[[-3,4],[-4,4],[-3,3]],[[-3,4],[-3,3],[-2,3]],[[4,1],[3,2],[3,1]],[[4,1],[3,1],[4,0]],[[4,1],[4,0],[5,0]],[[4,1],[5,0],[5,1]],[[5,0],[4,0],[5,-1]],[[5,0],[5,-1],[6,-1]],[[2,2],[1,3],[1,2]],[[2,2],[1,2],[2,1]],[[2,2],[2,1],[3,1]],[[2,2],[3,1],[3,2]],[[3,1],[2,1],[3,0]],[[3,1],[3,0],[4,0]],[[1,2],[0,2],[1,1]],[[1,2],[1,1],[2,1]],[[-1,2],[-2,3],[-2,2]],[[-1,2],[-2,2],[-1,1]],[[-1,2],[-1,1],[0,1]],[[-1,2],[0,1],[0,2]],[[0,1],[-1,1],[0,0]],[[0,1],[0,0],[1,0]],[[0,1],[1,0],[1,1]],[[0,1],[1,1],[0,2]],[[1,1],[1,0],[2,0]],[[1,1],[2,0],[2,1]],[[-3,3],[-4,4],[-4,3]],[[-3,3],[-4,3],[-3,2]],[[-3,3],[-3,2],[-2,2]],[[-3,3],[-2,2],[-2,3]],[[-2,2],[-3,2],[-2,1]],[[-2,2],[-2,1],[-1,1]],[[5,-1],[4,0],[4,-1]],[[5,-1],[4,-1],[5,-2]],[[5,-1],[5,-2],[6,-2]],[[-5,4],[-4,3],[-4,4]],[[-4,3],[-5,3],[-4,2]],[[-4,3],[-4,2],[-3,2]],[[3,0],[2,1],[2,0]],[[3,0],[2,0],[3,-1]],[[3,0],[3,-1],[4,-1]],[[3,0],[4,-1],[4,0]],[[4,-1],[3,-1],[4,-2]],[[4,-1],[4,-2],[5,-2]],[[2,0],[1,0],[2,-1]],[[2,0],[2,-1],[3,-1]],[[0,0],[-1,1],[-1,0]],[[0,0],[-1,0],[0,-1]],[[0,0],[0,-1],[1,-1]],[[0,0],[1,-1],[1,0]],[[1,-1],[0,-1],[1,-2]],[[1,-1],[1,-2],[2,-2]],[[1,-1],[2,-2],[2,-1]],[[1,-1],[2,-1],[1,0]],[[2,-1],[2,-2],[3,-2]],[[2,-1],[3,-2],[3,-1]],[[-2,1],[-3,2],[-3,1]],[[-2,1],[-3,1],[-2,0]],[[-2,1],[-2,0],[-1,0]],[[-2,1],[-1,0],[-1,1]],[[-1,0],[-2,0],[-1,-1]],[[-1,0],[-1,-1],[0,-1]],[[6,-3],[5,-2],[5,-3]],[[-4,2],[-5,2],[-4,1]],[[-4,2],[-4,1],[-3,1]],[[-4,2],[-3,1],[-3,2]],[[-3,1],[-4,1],[-3,0]],[[-3,1],[-3,0],[-2,0]],[[4,-2],[3,-1],[3,-2]],[[4,-2],[3,-2],[4,-3]],[[4,-2],[4,-3],[5,-3]],[[4,-2],[5,-3],[5,-2]],[[5,-3],[4,-3],[5,-4]],[[5,-3],[5,-4],[6,-4]],[[3,-2],[2,-2],[3,-3]],[[3,-2],[3,-3],[4,-3]],[[1,-2],[0,-1],[0,-2]],[[1,-2],[0,-2],[1,-3]],[[1,-2],[1,-3],[2,-3]],[[1,-2],[2,-3],[2,-2]],[[2,-3],[1,-3],[2,-4]],[[2,-3],[2,-4],[3,-4]],[[2,-3],[3,-4],[3,-3]],[[2,-3],[3,-3],[2,-2]],[[3,-3],[3,-4],[4,-4]],[[3,-3],[4,-4],[4,-3]],[[-1,-1],[-2,0],[-2,-1]],[[-1,-1],[-2,-1],[-1,-2]],[[-1,-1],[-1,-2],[0,-2]],[[-1,-1],[0,-2],[0,-1]],[[0,-2],[-1,-2],[0,-3]],[[0,-2],[0,-3],[1,-3]],[[-3,0],[-4,1],[-4,0]],[[-3,0],[-4,0],[-3,-1]],[[-3,0],[-3,-1],[-2,-1]],[[-3,0],[-2,-1],[-2,0]],[[-2,-1],[-3,-1],[-2,-2]],[[-2,-1],[-2,-2],[-1,-2]],[[5,-4],[4,-3],[4,-4]],[[5,-4],[4,-4],[5,-5]],[[5,-4],[5,-5],[6,-5]],[[-5,1],[-4,0],[-4,1]],[[6,-5],[5,-5],[6,-6]],[[-4,0],[-4,-1],[-3,-1]],[[4,-4],[3,-4],[4,-5]],[[4,-4],[4,-5],[5,-5]],[[2,-4],[1,-3],[1,-4]],[[2,-4],[1,-4],[2,-5]],[[2,-4],[2,-5],[3,-5]],[[2,-4],[3,-5],[3,-4]],[[3,-5],[2,-5],[3,-6]],[[3,-5],[3,-6],[4,-6]],[[3,-5],[4,-6],[4,-5]],[[3,-5],[4,-5],[3,-4]],[[4,-5],[4,-6],[5,-6]],[[4,-5],[5,-6],[5,-5]],[[0,-3],[-1,-2],[-1,-3]],[[0,-3],[-1,-3],[0,-4]],[[0,-3],[0,-4],[1,-4]],[[0,-3],[1,-4],[1,-3]],[[1,-4],[0,-4],[1,-5]],[[1,-4],[1,-5],[2,-5]],[[-2,-2],[-3,-1],[-3,-2]],[[-2,-2],[-3,-2],[-2,-3]],[[-2,-2],[-2,-3],[-1,-3]],[[-2,-2],[-1,-3],[-1,-2]],[[-1,-3],[-2,-3],[-1,-4]],[[-1,-3],[-1,-4],[0,-4]],[[6,-6],[5,-5],[5,-6]],[[6,-6],[5,-6],[6,-7]],[[-4,-1],[-4,-2],[-3,-2]],[[-4,-1],[-3,-2],[-3,-1]],[[-3,-2],[-4,-2],[-3,-3]],[[-3,-2],[-3,-3],[-2,-3]],[[5,-6],[4,-6],[5,-7]],[[5,-6],[5,-7],[6,-7]],[[2,-6],[2,-5],[1,-5]],[[2,-6],[1,-5],[1,-6]],[[2,-6],[1,-6],[2,-7]],[[3,-6],[4,-7],[4,-6]],[[1,-7],[1,-6],[0,-6]],[[1,-7],[0,-6],[0,-7]],[[1,-5],[0,-4],[0,-5]],[[1,-5],[0,-5],[1,-6]],[[-1,-4],[-2,-3],[-2,-4]],[[0,-5],[0,-6],[1,-6]]]];

#%%

u_arcs = np.array(unfolding_arcs[0])
u_pos = np.array(unfolding_arcpos[0])
u_tripos = np.array(unfolding_tripos[0])

#%% 

faces_index = []
u_Test = u_pos[:,0]

for f in u_tripos:
    tindexes = []
    for a in f:
        #print(a)
        coor1 = np.where(u_pos[:,0,0] == a[0])
        #print(coor1)
        for i in coor1[0]:
            #print(i)
            #print(u_pos[i,0,1])
            #print(a[1])
            if u_pos[i,0,1] == a[1]:
                aindex = u_arcs[i,0]
        tindexes.append(aindex)
    faces_index.append(tindexes)


for i in range(len(faces_index)):
    f = faces_index[i]
    pos = np.where(f == np.max(f))[0][0]
    faces_index[i] = np.roll(f, 2-pos)
    print(pos)

#%% 

# Multiply the Eisenstein coordinates by the conversion matrix
faces_coor = []
m = np.array([[1,np.cos(np.pi/3)],[0,np.sin(np.pi/3)]])

for c in u_tripos:
    faces_coor.append(np.dot(c,m.T) - [2,0])    
faces_coor = np.array(faces_coor)
              
for t in faces_coor:
    a = np.array([t[0],t[1],t[2],t[0]]).T
    plt.plot(a[0],a[1])
    
    
#%%

for t in u_tripos:
    a = np.array([t[0],t[1],t[2],t[0]]).T
    plt.plot(a[0],a[1])
    
for f in range(len(faces_index)):
    t = faces_index[f]
    print(t)
    maxin = np.where(t == np.max(t))[0][0]
    print(f)
    print(maxin)
    ind = u_tripos[f,maxin]
    print(ind)
    plt.scatter(u_tripos[f,maxin][0],u_tripos[f,maxin][1])

#%% 

pentagonmids = np.zeros(12)
hexagonmids = np.zeros(20)

for n in range(60,92):
    a = np.where(np.array(faces_index) == n)
    if len(a[0]) == 5:
        tindex = a[0][0]
        tlist = faces_index[tindex]
        index1 = tlist[a[1][0]-1]
        index2 = tlist[a[1][0]-2]
        findshape = np.array(np.where(pentagons[0] == index1)).T
        for f in findshape:
            if pentagons[0][f[0],f[1]-1] == index2:
                pentagonmids[f[0]] = n
    else:
        tindex = a[0][0]
        tlist = faces_index[tindex]
        index1 = tlist[a[1][0]-1]
        index2 = tlist[a[1][0]-2]
        findshape = np.array(np.where(hexagons[0] == index1)).T
        for f in findshape:
            if hexagons[0][f[0],f[1]-1] == index2:
                hexagonmids[f[0]] = n 
#%%

for t in faces_coor:
    a = np.array([t[0],t[1],t[2],t[0]]).T
    plt.plot(a[0],a[1])

for p in hexagonmids:
    l = np.where(faces_index == p)
    print(l)
    f = faces_coor[l[0][0],l[1][0]]
    print(f)
    plt.scatter(f[0],f[1])


#%% Export

molecule = 'C60-1'

np.save(molecule + '_indexes', faces_index)
np.save(molecule + '_positions', u_tripos)

np.save(molecule + '_pmids', pentagonmids)
np.save(molecule + '_hmids', hexagonmids)